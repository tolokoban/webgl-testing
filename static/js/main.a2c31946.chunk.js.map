{"version":3,"sources":["gl/assets/palette/default-64.png","gl/camera/perpective/perspective.world-point-to-screen.vert","gl/shader/model/model.main.frag","gl/shader/model/model.main.vert","gl/pointer.ts","gl/async-loader.ts","gl/types.ts","gl/factory/texture/image-texture.ts","gl/factory/texture/texture.ts","gl/factory/texture/texture-factory.ts","gl/scene/scene.ts","gl/resize.ts","gl/factory/model/model.ts","gl/assets-map.ts","gl/lookup-tables.ts","gl/program/uniform-setters.ts","gl/program/program.ts","gl/factory/shader/shader-factory.ts","gl/calc/calc.ts","gl/camera/abstract-camera.ts","gl/camera/space-3d.ts","gl/camera/perpective/perspective.ts","gl/shader/model/model.ts","gl/factory/model/model-factory.ts","App/App.tsx","serviceWorker.ts","index.tsx"],"names":["module","exports","Pointer","canvas","_x","_y","_down","_downTime","_eventDown","_eventUp","onMouseMove","evt","computeCoords","clientX","clientY","onTouchMove","te","touches","onMouseDown","onDown","onTouchStart","onMouseUp","onUp","onTouchEnd","this","window","addEventListener","x","y","Date","now","pointerX","pointerY","rect","getBoundingClientRect","left","top","w","width","h","height","loadImage","url","Promise","resolve","reject","img","Image","onload","onerror","console","error","src","loadJson","loadText","a","fetch","request","text","JSON","parse","IAttributeType","IUniformType","IVaryingType","ImageTexture","params","gl","id","smoothness","linear","LINEAR","NEAREST","bindTexture","TEXTURE_2D","texture","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","TEXTURE_MAG_FILTER","texImage2D","RGBA","UNSIGNED_BYTE","source","target","sharingCounter","_isDestroyed","units","createTexture","Error","TEXTURE_CUBE_MAP","TEXTURE0","TEXTURE1","TEXTURE2","TEXTURE3","TEXTURE4","TEXTURE5","TEXTURE6","TEXTURE7","TEXTURE8","TEXTURE9","TEXTURE10","TEXTURE11","TEXTURE12","TEXTURE13","TEXTURE14","TEXTURE15","deleteTexture","unitIndex","length","activeTexture","TextureFactory","AsyncLoader","Scene","resolution","onAnimation","_gl","_pointer","_isRendering","lastRenderingTime","textures","render","time","requestAnimationFrame","_resolution","devicePixelRatio","HTMLCanvasElement","displayWidth","Math","floor","clientWidth","displayHeight","clientHeight","viewport","Resize","clearDepth","clear","DEPTH_BUFFER_BIT","depthFunc","LESS","disable","DEPTH_TEST","drawingBufferWidth","drawingBufferHeight","pointer","reset","ex","getContext","savedRendering","savedLastRenderingTime","value","Model","buffer","program","attributesCount","name","info","use","attachToUnit","uniforms","set","thickness","bindAttribs","drawArrays","TRIANGLES","AssetsMap","map","Map","has","item","get","count","delete","getAttributeSize","type","FLOAT_VEC2","FLOAT_VEC3","FLOAT_VEC4","getAttributeTypeCodeName","mapEnumAttributeTypeToStringType","getUniformTypeCodeName","mapEnumUniformTypeToStringType","getVaryingTypeCodeName","mapEnumVaryingTypeToStringType","getWebGLTypeFromAttributeType","FLOAT","FLOAT_MAT2","FLOAT_MAT3","FLOAT_MAT4","BOOL","BYTE","SHORT","INT","UNSIGNED_SHORT","UNSIGNED_INT","SAMPLER_2D","SAMPLER_CUBE","UniformSetter","prg","uniformsDefinition","uniformSetters","attachProgram","setter","Object","keys","uniformName","getUniformLocation","uniformType","isArray","size","attachProgramInt","attachProgramFloat","attachProgramVec2","attachProgramVec3","attachProgramVec4","attachProgramMat2","attachProgramMat3","attachProgramMat4","displayWarningForNotFoundUniform","location","v","uniform1iv","uniform1i","uniform1fv","uniform1f","uniform2fv","uniform3fv","uniform4fv","uniformMatrix2fv","uniformMatrix3fv","uniformMatrix4fv","warn","BPE","Float32Array","BYTES_PER_ELEMENT","Program","vertexShader","fragmentShader","attributes","bindBuffer","ARRAY_BUFFER","attrib","enableVertexAttribArray","vertexAttribPointer","normalization","totalSize","offset","detach","flatVertShader","flattenShaderDependencies","flatFragShader","varyings","flatVertShaderToCode","vertShaderCode","flatFragShaderToCode","fragShaderCode","vertShader","createVertexShader","fragShader","createFragementShader","createProgram","attachShader","linkProgram","prepareUniformsForFastBinding","deleteProgram","attDef","attName","attType","getAttribLocation","LookupTables","push","useProgram","code","createShader","VERTEX_SHADER","FRAGMENT_SHADER","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","errorMessage","getShaderInfoLog","result","lines","split","lineNumber","line","pad","join","writeLineNumbers","unshift","RX_ERROR_MESSAGE","lastIndex","matcher","exec","lineNumberMatch","Number","firstLine","max","lastLine","min","outputLines","n","getCodeSection","uniCode","getUniformsSourceCode","attCode","getAttributesSourceCode","varCode","getVaryingsSourceCode","getFunctionsSourceCode","functions","codeForFunctions","typeEnum","arraySuffix","typeString","functionNames","functionName","pop","functionCodeUrlOrArray","Array","functionCode","shadersAlreadyLoaded","flattenedShader","attributesDefinition","functionsDefinition","varyingsDefinition","main","dependenciesDefinition","depShader","indexOf","depFlattenedShader","mergeAttributes","mergeUniforms","mergeVaryings","mergeFunctions","constructor","oldFunctions","newFunctions","funName","oldFun","newFun","oldAttribs","newAttribs","oldAtt","newAtt","oldUniforms","newUniforms","uniName","oldUni","newUni","oldVarying","newVarying","varName","oldVar","newVar","num","len","txt","def","CustomShader","definition","convertFriendlyUniforms","convertFriendlyAttributes","convertFriendlyVaryings","dependencies","key","convertFriendlyUniform","uniform","stringType","convertFriendlyAttribute","attribute","convertFriendlyVarying","varying","AbstractCamera","COS","SIN","i","angle","PI","cos","sin","vector","areEqual","b","createVec3","createVec4","cross3","output","dot3","xa","ya","za","length3","input","sqrt","normalize3","orbital3","latitude","longitude","radius","length4","z","normalize4","transform4","mat","vec","out","matrix","createMat3","createMat4","identity3","extract3From4","mat4","mat3","multiply3","identity4","multiply4","output00","output10","output20","output30","output01","output11","output21","output31","output02","output12","output22","output32","output03","output13","output23","output33","invert4","a00","a10","a20","a30","a01","a11","a21","a31","a02","a12","a22","a32","a03","a13","a23","a33","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","invDet","abs","det","rotation4X","c","s","rotation4Y","rotation4Z","deg2rad","deg","rad2deg","rad","FULL_TURN","clamp","M4_00","M4_10","M4_20","M4_30","M4_01","M4_11","M4_21","M4_31","M4_02","M4_12","M4_22","M4_32","M4_03","M4_13","M4_23","M4_33","M3_00","M3_10","M3_20","M3_01","M3_11","M3_21","M3_02","M3_12","M3_22","Space3D","cameraMatrix","Calc","rotationY","rotationX","transfo","targetX","targetY","targetZ","distance","lat","lng","tX","tY","tZ","DEFAULT_FIELD_ANGLE_RAD","ShaderFactory","uniPerspectiveMatrix","uniCameraMatrix","worldPointToScreen","PerspectiveVertexShaderCode","Perspective","perspectiveMatrix","fieldAngle","near","far","orbit","f","tan","rangeInv","VertexShader","PerspectiveCamera","vert","attLocation","attUV","attNormal","attValley","attWeight","varNormal","varValley","varWeight","varUV","VertShaderMain","frag","uniTexture","uniThickness","uniSmoothness","FragShaderMain","ModelsFactory","scene","infoMap","programMap","textureMap","exists","createInfo","PaletteTextureUrl","modelDef","modelBuff","createBuffer","modelData","createTriangles","data","bufferData","STATIC_DRAW","modelInfo","add","ModelShader","attach","createImageTextureAsync","cursor","chunkSize","chunk","slice","createTriangle","triCoords","ax","ay","az","au","av","nax","nay","naz","bx","by","bz","bu","bv","nbx","nby","nbz","cx","cy","cz","cu","cv","ncx","ncy","ncz","distToEdge","px","py","e1x","e1y","e2x","e2y","edgeLength","squaredDist","cross","Slider","Tfw","View","App","state","refCanvas","React","createRef","camera","refresh","Throttler","current","modelFactory","ModelFactory","createAsync","car","clearColor","enable","COLOR_BUFFER_BIT","setUniformValues","paint","isRendering","classes","props","className","ref","label","step","onChange","setState","Component","Boolean","hostname","match","Theme","register","bg0","bg3","apply","Font","loadJosefin","ReactDOM","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","message"],"mappings":"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","file":"static/js/main.a2c31946.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV/TlopUBC0o4pChOlkQFXHUKhShQqgVWnUwufQLmjQkLS6OgmvBwY/FqoOLs64OroIg+AHi5Oik6CIl/i8ptIjx4Lgf7+497t4BQqPMNCswDmh61Uwl4mImuyqGXhHEAPogIiAzy5iTpCQ8x9c9fHy9i/Es73N/jh41ZzHAJxLPMsOsEm8QT29WDc77xBFWlFXic+Ixky5I/Mh1xeU3zgWHBZ4ZMdOpeeIIsVjoYKWDWdHUiKeIo6qmU76QcVnlvMVZK9dY6578heGcvrLMdZrDSGARS5CoIwU1lFBGFTFadVIspGg/7uEfcvwSuRRylcDIsYAKNMiOH/wPfndr5Scn3KRwHAi+2PbHCBDaBZp12/4+tu3mCeB/Bq70tr/SAGY+Sa+3tegR0LsNXFy3NWUPuNwBBp8M2ZQdyU9TyOeB9zP6pizQfwt0r7m9tfZx+gCkqavkDXBwCIwWKHvd491dnb39e6bV3w83Y3KPBkDkrQAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB+QFFxIrHU779cwAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAA+ElEQVQY0wXBTUoCcQDG4d/gYGTRXnAVEe1s0QWijUeIoBPksiO0i+gIQWUgtAj7AG0RVEQShFk2TTlOk/xRpI8hHauFvj2PFXUjheEnnU6bpjG8eD6u6+A4LkEQYJ9HCQqtBDvVMXqlU/x8nOvGPSMPFf5OfkDFLWlxUpU5tJlC+t6VvGmFRXS8gWzGC5AxpBsQ80BXT7RfZ3DuulT9FpYeL4WpQ7PEe7fFYdnHBB88tyMq/SHWoCYNajA8Am+7jrU/xc0euGc9br9ysHIgpdYklstiNqslZTXRQaPrKLaA7Ew6JBn3qf5e4Jo3co1VMPP07Tr5ZMg/fZKNCEDKD+MAAAAASUVORK5CYII=\"","module.exports = __webpack_public_path__ + \"static/media/perspective.world-point-to-screen.c20b4adb.vert\";","module.exports = __webpack_public_path__ + \"static/media/model.main.0394a779.frag\";","module.exports = __webpack_public_path__ + \"static/media/model.main.6fa5d353.vert\";","const HALF = 0.5\nconst DOUBLE = 2\n\nexport default class Pointer {\n    private _x = 0\n    private _y = 0\n    private _down = false\n    // If 0, pointer is up.\n    private _downTime = 0\n    private _eventDown = false\n    private _eventUp = false\n    private readonly canvas: HTMLCanvasElement\n\n    /** @hidden */\n    constructor(canvas: HTMLCanvasElement) {\n        this.canvas = canvas\n        window.addEventListener('mousemove', this.onMouseMove, true)\n        window.addEventListener('touchmove', this.onTouchMove, true)\n        window.addEventListener('mousedown', this.onMouseDown, true)\n        window.addEventListener('touchstart', this.onTouchStart, true)\n        window.addEventListener('mouseup', this.onMouseUp, true)\n        window.addEventListener('touchend', this.onTouchEnd, true)\n    }\n\n    /** @hidden */\n    reset() {\n        this._eventDown = false\n        this._eventUp = false\n    }\n\n    get x() {\n        return this._x\n    }\n    get y() {\n        return this._y\n    }\n\n    /** Test if the pointer is touching the screen. */\n    get down() {\n        return this._down\n    }\n    /** `true` only if the pointer started touching the screen this very last frame. */\n    get eventUp() {\n        return this._eventUp\n    }\n    /** `true` only if the pointer stopped touching the screen this very last frame. */\n    get eventDown() {\n        return this._eventDown\n    }\n\n    private readonly onMouseMove = (evt: MouseEvent) => {\n        this.computeCoords(evt.clientX, evt.clientY)\n    }\n\n    private readonly onTouchMove = (te: TouchEvent) => {\n        const evt = te.touches[0]\n        this.computeCoords(evt.clientX, evt.clientY)\n    }\n\n    private readonly onMouseDown = (evt: MouseEvent) => {\n        this.onDown(evt.clientX, evt.clientY)\n    }\n\n    private readonly onTouchStart = (te: TouchEvent) => {\n        const evt = te.touches[0]\n        this.onDown(evt.clientX, evt.clientY)\n    }\n\n    private onDown(x: number, y: number) {\n        if (this._downTime !== 0) { return }\n        this.computeCoords(x, y)\n        this._down = true\n        this._eventDown = true\n        this._downTime = Date.now()\n    }\n\n    private readonly onMouseUp = (evt: MouseEvent) => {\n        this.onUp(evt.clientX, evt.clientY)\n    }\n\n    private readonly onTouchEnd = (te: TouchEvent) => {\n        const evt = te.touches[0]\n        this.onUp(evt.clientX, evt.clientY)\n    }\n\n    private onUp(x: number, y: number) {\n        if (this._downTime === 0) { return }\n        this.computeCoords(x, y)\n        this._down = false\n        this._eventUp = true\n        this._downTime = 0\n    }\n\n    private computeCoords(pointerX: number, pointerY: number) {\n        const { canvas } = this\n        const rect = canvas.getBoundingClientRect()\n\n        const x = pointerX - rect.left\n        const y = pointerY - rect.top\n        const w = rect.width\n        const h = rect.height\n\n        this._x = DOUBLE * (x / w - HALF)\n        this._y = DOUBLE * (y / h - HALF)\n    }\n}\n","export default {\n    loadImage,\n    loadJson,\n    loadText\n}\n\n\nfunction loadImage(url: string): Promise<HTMLImageElement> {\n    return new Promise((resolve, reject) => {\n        const img = new Image()\n        img.onload = () => resolve(img)\n        img.onerror = () => {\n            console.error(\"Unable to load image from URL:\", url)\n            reject(url)\n        }\n        img.src = url\n    })\n}\n\n\nasync function loadText(url: string): Promise<string> {\n    try {\n        const request = await fetch(url)\n        const text = await request.text()\n        return text\n    } catch (ex) {\n        console.error(\"Unable to load text from URL:\", url)\n        console.error(ex)\n        throw ex\n    }\n}\n\n\nasync function loadJson(url: string): Promise<{ [key: string]: any }> {\n    const text = await loadText(url)\n    try {\n        return JSON.parse(text)\n    } catch (ex) {\n        console.error(\"Unable to parse JSON:\", url)\n        console.error(ex)\n        throw ex\n    }\n}\n","export enum IAttributeType {\n    //INT, BYTE, SHORT, UNSIGNED_INT, UNSIGNED_BYTE, UNSIGNED_SHORT,\n    FLOAT, FLOAT_VEC2, FLOAT_VEC3, FLOAT_VEC4\n}\n\nexport enum IUniformType {\n    FLOAT, FLOAT_VEC2, FLOAT_VEC3, FLOAT_VEC4, FLOAT_MAT2, FLOAT_MAT3, FLOAT_MAT4,\n    BYTE, UNSIGNED_BYTE, SHORT, UNSIGNED_SHORT, INT, UNSIGNED_INT,\n    BOOL,\n    SAMPLER_2D, SAMPLER_CUBE\n}\n\nexport enum IVaryingType {\n    FLOAT, FLOAT_VEC2, FLOAT_VEC3, FLOAT_VEC4, FLOAT_MAT2, FLOAT_MAT3, FLOAT_MAT4\n}\n\nexport interface IAttributeTypes { [key: string]: IAttributeType }\n\nexport interface IFunctionTypes { [key: string]: string | string[] }\n\nexport interface IUniformTypes {\n    [key: string]: {\n        type: IUniformType,\n        size?: number\n    }\n}\n\nexport interface IVaryingTypes {\n    [key: string]: {\n        type: IVaryingType,\n        size?: number\n    }\n}\n\nexport type IUniformSetterNumber = (value: number) => void\nexport type IUniformSetterFloat32Array = (value: Float32Array) => void\nexport type IUniformSetterInt32Array = (value: Int32Array) => void\nexport type IUniformSetter = IUniformSetterNumber | IUniformSetterFloat32Array | IUniformSetterInt32Array\n\nexport type IWebGL = WebGLRenderingContext | WebGL2RenderingContext\n\nexport type IVec3 = Float32Array\nexport type IVec4 = Float32Array\nexport type IMat3 = Float32Array\nexport type IMat4 = Float32Array\n","import Texture from './texture'\nimport { IWebGL } from '../../types'\n\nexport interface IImageTextureParams {\n    id: string,\n    gl: IWebGL,\n    source: HTMLImageElement | HTMLCanvasElement,\n    width: number,\n    height: number,\n    linear: boolean\n}\n\nexport default class ImageTexture extends Texture {\n    constructor(private readonly params: IImageTextureParams) {\n        super(params.gl, params.id, \"2d\")\n\n        const { gl } = params\n        const smoothness = params.linear ? gl.LINEAR : gl.NEAREST\n        gl.bindTexture(gl.TEXTURE_2D, this.texture)\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE)\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE)\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, smoothness)\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, smoothness)\n\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, params.source)\n    }\n\n    get width() { return this.params.width }\n    get height() { return this.params.height }\n\n    update(source: HTMLImageElement | HTMLCanvasElement) {\n        const { gl } = this.params\n        gl.bindTexture(gl.TEXTURE_2D, this.texture)\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, source)\n    }\n}\n","import { IWebGL } from '../../types'\n\ntype ITarget = \"2d\" | \"cubeMap\" | \"3d\" | \"2dArray\"\n\nexport default abstract class Texture {\n    private sharingCounter = 0\n    private _isDestroyed = false\n    protected readonly texture: WebGLTexture\n    protected readonly target: GLenum\n    protected readonly units: GLenum[]\n\n    constructor(\n        protected readonly gl: IWebGL,\n        protected readonly id: string,\n        target: ITarget) {\n\n        const texture = gl.createTexture()\n        if (!texture) throw Error(`[FlatLand] Unable to create texture \"${id}\"!`)\n        this.texture = texture\n        switch (target) {\n            case \"2d\":\n                this.target = gl.TEXTURE_2D\n                break\n            case \"cubeMap\":\n                this.target = gl.TEXTURE_CUBE_MAP\n                break\n            /*\n            case \"3d\":\n                this.target = gl.TEXTURE_3D\n                break\n            case \"2dArray\":\n                this.target = gl.TEXTURE_2D_ARRAY\n                break\n            */\n            default:\n                throw Error(`[FlatLand.Texture] Unknow target \"${target}\"! Available targets are \"2d\", \"cubeMap\", \"3d\" and \"2dArray\".`)\n        }\n        this.units = [\n            gl.TEXTURE0,\n            gl.TEXTURE1,\n            gl.TEXTURE2,\n            gl.TEXTURE3,\n            gl.TEXTURE4,\n            gl.TEXTURE5,\n            gl.TEXTURE6,\n            gl.TEXTURE7,\n            gl.TEXTURE8,\n            gl.TEXTURE9,\n            gl.TEXTURE10,\n            gl.TEXTURE11,\n            gl.TEXTURE12,\n            gl.TEXTURE13,\n            gl.TEXTURE14,\n            gl.TEXTURE15\n        ]\n    }\n\n    get isDestroyed() { return this._isDestroyed }\n\n    /**\n     * Many painters can share the same texture.\n     * For memory management, it's important to know\n     * how many users this texture has to be shared with.\n     *\n     * Call share() as soon as you need to use a texture\n     * and destroy() as soon as you don't need it anymore.\n     */\n    share() {\n        this.sharingCounter++\n    }\n\n    /**\n     * Remove the texture from the graphic card memory\n     * as soon as no one is using it anymore.\n     */\n    destroy() {\n        if (this._isDestroyed) return\n\n        if (this.sharingCounter > 0) {\n            this.sharingCounter--\n            return\n        }\n        const { gl, texture } = this\n        gl.deleteTexture(texture)\n        this._isDestroyed = true\n    }\n\n    /**\n     * Attach this texture to a unit.\n     * If you use only one unit, your texture must be attached to unit 0.\n     */\n    attachToUnit(unitIndex: number) {\n        const { gl, texture, target, units } = this\n        if (unitIndex < 0) throw Error(\"[FlatLand.Texture.attachToUnit] unitIndex must be positive!\")\n        if (unitIndex > units.length - 1) throw Error(`[FlatLand.Texture.attachToUnit] unitIndex must be lower than ${units.length}!`)\n        gl.activeTexture(units[unitIndex])\n        gl.bindTexture(target, texture)\n    }\n}\n","import AsyncLoader from '../../async-loader'\n//import Texture from './texture/image-texture'\nimport ImageTexture from './image-texture'\nimport { IWebGL } from '../../types'\n\nexport default class TextureFactory {\n    constructor(private gl: IWebGL) { }\n\n    async createImageTextureAsync(url: string): Promise<ImageTexture> {\n        const { gl } = this\n        const img = await AsyncLoader.loadImage(url)\n        const texture = new ImageTexture({\n            gl,\n            id: url,\n            source: img,\n            width: img.width,\n            height: img.height,\n            linear: false\n        })\n        return texture\n    }\n}\n","import Pointer from '../pointer'\nimport Resize from '../resize'\nimport TextureFactory from '../factory/texture'\n\ntype IAnimationFunction = (time: number, width: number, height: number) => void\nexport interface ISceneParams {\n    canvas: HTMLCanvasElement\n    onAnimation?: IAnimationFunction\n}\n\nexport default class Scene {\n    resolution = 1\n    onAnimation?: IAnimationFunction\n\n    private readonly _gl: WebGL2RenderingContext\n    private readonly _pointer: Pointer\n    private _isRendering = false\n    private lastRenderingTime = 0\n    public readonly textures: TextureFactory\n\n    constructor(canvas: HTMLCanvasElement) {\n        this._pointer = new Pointer(canvas)\n        const gl = canvas.getContext('webgl2', {\n            // Specify WebGL options.\n        })\n        if (!gl) {\n            throw new Error('Unable to create a WegGL context!')\n        }\n\n        this._gl = gl\n        this.textures = new TextureFactory(gl)\n    }\n\n    get isRendering() { return this._isRendering }\n    set isRendering(value: boolean) {\n        if (value === this._isRendering) return\n        this._isRendering = value\n        if (value) {\n            window.requestAnimationFrame(this.render)\n        }\n    }\n\n    get gl(): WebGL2RenderingContext {\n        return this._gl\n    }\n\n    /**\n     * Retreive information about pointer (mouse, pen, finger, ...) state.\n     */\n    get pointer() {\n        return this._pointer\n    }\n\n    /**\n     * Visible width. Between 0 and 1024.\n     */\n    get width(): number {\n        return this._gl.drawingBufferWidth\n    }\n    /**\n     * Visible height. Between 0 and 1024.\n     */\n    get height(): number {\n        return this._gl.drawingBufferHeight\n    }\n\n    /**\n     * Trigger a rendering now.\n     */\n    refresh() {\n        const savedRendering = this._isRendering\n        const savedLastRenderingTime = this.lastRenderingTime\n        this._isRendering = true\n        const time = Date.now()\n        this.lastRenderingTime = time - 15\n        this.render(time)\n        this._isRendering = savedRendering\n        this.lastRenderingTime = savedLastRenderingTime\n    }\n\n    private readonly render = (time: number) => {\n        if (!this._isRendering) return\n        window.requestAnimationFrame(this.render)\n\n        const { gl, lastRenderingTime } = this\n        this.lastRenderingTime = time\n        if (lastRenderingTime === 0) {\n            // Skip the first frame to have a correct delta time.\n            return\n        }\n\n        const delta = time - lastRenderingTime\n\n        Resize(gl, this.resolution)\n\n        gl.clearDepth(+1)\n        gl.clear(gl.DEPTH_BUFFER_BIT)\n        gl.depthFunc(gl.LESS)\n        gl.disable(gl.DEPTH_TEST)\n\n        try {\n            const { onAnimation } = this\n            if (typeof onAnimation === 'function') {\n                const width = gl.drawingBufferWidth\n                const height = gl.drawingBufferHeight\n                onAnimation(time, width, height)\n                this.pointer.reset()\n            }\n        } catch (ex) {\n            this._isRendering = false\n            console.error('##################################')\n            console.error('# Rendering   has  been  stopped #')\n            console.error('# because of the following error #')\n            console.error('#################################')\n            console.error(ex)\n        }\n    }\n}\n","/**\n * Resolution in CSS pixels. If omitted, the real resolution\n * of the device is taken. On smartphones, for instance,\n * the resolution is often greater than 1.\n *\n * Return `true` if the size has changed.\n */\nexport default (gl: WebGLRenderingContext, _resolution = 0) => {\n  const resolution = _resolution <= 0 ? window.devicePixelRatio : _resolution\n\n  const canvas = gl.canvas\n  if (canvas instanceof HTMLCanvasElement) {\n    const displayWidth = Math.floor(canvas.clientWidth * resolution)\n    const displayHeight = Math.floor(canvas.clientHeight * resolution)\n\n    // Check if the canvas is not the same size.\n    if (canvas.width !== displayWidth || canvas.height !== displayHeight) {\n      // Make the canvas the same size\n      canvas.width = displayWidth\n      canvas.height = displayHeight\n      gl.viewport(0, 0, displayWidth, displayHeight)\n      return true\n    }\n  }\n  return false\n}\n","import { IWebGL } from '../../types'\nimport Program from '../../program'\nimport Texture from '../texture/texture'\n\nexport default class Model {\n    public readonly gl: IWebGL\n    public readonly buffer: WebGLBuffer\n    public readonly program: Program\n    public readonly texture: Texture\n    public readonly attributesCount: number\n    public readonly name: string\n\n    constructor(params: IModelParams) {\n        if (!params.buffer) throw Error(\"'buffer' is not defined!\")\n        console.info(\"params=\", params)\n        this.gl = params.gl\n        this.name = params.name\n        this.buffer = params.buffer\n        this.program = params.program\n        this.texture = params.texture\n        this.attributesCount = params.attributesCount\n    }\n\n    paint() {\n        const { gl, buffer, program, texture, attributesCount } = this\n        const thickness = 0.1\n        const smoothness = 0.5\n\n        program.use()\n        texture.attachToUnit(0)\n        program.uniforms.set(\"uniTexture\", 0)\n        program.uniforms.set(\"uniThickness\", thickness * (1 - smoothness))\n        program.uniforms.set(\"uniSmoothness\", thickness * smoothness)\n        program.bindAttribs(buffer)\n        gl.drawArrays(gl.TRIANGLES, 0, attributesCount)\n    }\n}\n\ninterface IModelParams {\n    attributesCount: number\n    buffer: WebGLBuffer\n    gl: IWebGL\n    name: string\n    program: Program\n    texture: Texture\n}\n","export default class AssetsMap<T> {\n    private map = new Map<string, { count: number, value: T }>()\n\n    /**\n     * Warning!\n     * If this function returns true,\n     * it also increments the link counter on the found item.\n     */\n    exists(id: string): boolean {\n        const { map } = this\n        if (map.has(id)) {\n            const item = map.get(id)\n            if (item) item.count++\n            return true\n        }\n        return false\n    }\n\n    get(id: string): T | undefined {\n        const item = this.map.get(id)\n        if (!item) return\n        return item.value\n    }\n\n    /**\n     * Warning!\n     * If an item with the same id already exists,\n     * this functioin will throw an exception.\n     */\n    add(id: string, value: T) {\n        const item = this.map.get(id)\n        if (!item) {\n            this.map.set(id, { count: 1, value })\n        } else {\n            throw Error(`An item with id \"${id}\" already exists!`)\n        }\n    }\n\n    /**\n     * Remove an item from the map and return -1 if this item does not exist.\n     * Otherwise, it will return the number of links still attached to this item.\n     * 0 means that no one is using this item anymore and cleanup can be performed.\n     */\n    remove(id: string): number {\n        const item = this.map.get(id)\n        if (!item) return -1\n        item.count--\n        if (item.count <= 0) {\n            this.map.delete(id)\n        }\n        return item.count\n    }\n}\n","import {\n    IWebGL,\n    IAttributeType,\n    IVaryingType,\n    IUniformType\n} from './types'\n\nexport default {\n    getAttributeSize,\n    getAttributeTypeCodeName,\n    getUniformTypeCodeName,\n    getVaryingTypeCodeName,\n    getWebGLTypeFromAttributeType\n}\n\nfunction getWebGLTypeFromAttributeType(gl: IWebGL, type: IAttributeType): number {\n    switch (type) {\n        case IAttributeType.FLOAT_VEC2: return gl.FLOAT_VEC2\n        case IAttributeType.FLOAT_VEC3: return gl.FLOAT_VEC3\n        case IAttributeType.FLOAT_VEC4: return gl.FLOAT_VEC4\n        default: return gl.FLOAT\n    }\n}\n\nfunction getAttributeTypeCodeName(type: IAttributeType): string | undefined {\n    return mapEnumAttributeTypeToStringType.get(type)\n}\n\nfunction getUniformTypeCodeName(type: IUniformType): string | undefined {\n    return mapEnumUniformTypeToStringType.get(type)\n}\n\nfunction getVaryingTypeCodeName(type: IVaryingType): string | undefined {\n    return mapEnumVaryingTypeToStringType.get(type)\n}\n\nfunction getAttributeSize(type: IAttributeType): number {\n    switch (type) {\n        case IAttributeType.FLOAT_VEC2: return 2\n        case IAttributeType.FLOAT_VEC3: return 3\n        case IAttributeType.FLOAT_VEC4: return 4\n        default: return 1\n    }\n}\n\n\nconst mapEnumAttributeTypeToStringType = new Map<IAttributeType, string>()\n\nmapEnumAttributeTypeToStringType.set(IAttributeType.FLOAT, \"float\")\nmapEnumAttributeTypeToStringType.set(IAttributeType.FLOAT_VEC2, \"vec2\")\nmapEnumAttributeTypeToStringType.set(IAttributeType.FLOAT_VEC3, \"vec3\")\nmapEnumAttributeTypeToStringType.set(IAttributeType.FLOAT_VEC4, \"vec4\")\n\nconst mapEnumVaryingTypeToStringType = new Map<IVaryingType, string>()\n\nmapEnumVaryingTypeToStringType.set(IVaryingType.FLOAT, \"float\")\nmapEnumVaryingTypeToStringType.set(IVaryingType.FLOAT_VEC2, \"vec2\")\nmapEnumVaryingTypeToStringType.set(IVaryingType.FLOAT_VEC3, \"vec3\")\nmapEnumVaryingTypeToStringType.set(IVaryingType.FLOAT_VEC4, \"vec4\")\nmapEnumVaryingTypeToStringType.set(IVaryingType.FLOAT_MAT2, \"mat2\")\nmapEnumVaryingTypeToStringType.set(IVaryingType.FLOAT_MAT3, \"mat3\")\nmapEnumVaryingTypeToStringType.set(IVaryingType.FLOAT_MAT4, \"mat4\")\n\nconst mapEnumUniformTypeToStringType = new Map<IUniformType, string>()\n\nmapEnumUniformTypeToStringType.set(IUniformType.BOOL, \"bool\")\nmapEnumUniformTypeToStringType.set(IUniformType.BYTE, \"int\")\nmapEnumUniformTypeToStringType.set(IUniformType.SHORT, \"int\")\nmapEnumUniformTypeToStringType.set(IUniformType.INT, \"int\")\nmapEnumUniformTypeToStringType.set(IUniformType.UNSIGNED_BYTE, \"uint\")\nmapEnumUniformTypeToStringType.set(IUniformType.UNSIGNED_SHORT, \"uint\")\nmapEnumUniformTypeToStringType.set(IUniformType.UNSIGNED_INT, \"uint\")\nmapEnumUniformTypeToStringType.set(IUniformType.SAMPLER_2D, \"sampler2D\")\nmapEnumUniformTypeToStringType.set(IUniformType.SAMPLER_CUBE, \"samplerCube\")\nmapEnumUniformTypeToStringType.set(IUniformType.FLOAT, \"float\")\nmapEnumUniformTypeToStringType.set(IUniformType.FLOAT_VEC2, \"vec2\")\nmapEnumUniformTypeToStringType.set(IUniformType.FLOAT_VEC3, \"vec3\")\nmapEnumUniformTypeToStringType.set(IUniformType.FLOAT_VEC4, \"vec4\")\nmapEnumUniformTypeToStringType.set(IUniformType.FLOAT_MAT2, \"mat2\")\nmapEnumUniformTypeToStringType.set(IUniformType.FLOAT_MAT3, \"mat3\")\nmapEnumUniformTypeToStringType.set(IUniformType.FLOAT_MAT4, \"mat4\")\n","import {\n    IUniformSetter,\n    IUniformTypes,\n    IUniformType,\n    IWebGL\n} from '../types'\n\nexport default class UniformSetter {\n    private uniformSetters = new Map<string, IUniformSetter>()\n\n    constructor(\n        gl: IWebGL,\n        prg: WebGLProgram,\n        private uniformsDefinition: IUniformTypes\n    ) {\n        this.attachProgram(gl, prg)\n    }\n\n    set(name: string, value: number | Float32Array | Int32Array) {\n        const setter = this.uniformSetters.get(name)\n        if (!setter) return\n        setter(value as any)\n    }\n\n    exists(name: string): boolean {\n        return this.uniformSetters.has(name)\n    }\n\n    private attachProgram(gl: IWebGL, prg: WebGLProgram) {\n        for (const uniformName of Object.keys(this.uniformsDefinition)) {\n            const location: WebGLUniformLocation | null =\n                gl.getUniformLocation(prg, uniformName)\n            if (!location) {\n                displayWarningForNotFoundUniform(uniformName)\n                continue\n            }\n\n            const uniformType = this.uniformsDefinition[uniformName]\n            const isArray = uniformType.size && uniformType.size > 1 ? true : false\n\n            switch (uniformType.type) {\n                case IUniformType.BYTE:\n                case IUniformType.UNSIGNED_BYTE:\n                case IUniformType.SHORT:\n                case IUniformType.UNSIGNED_SHORT:\n                case IUniformType.INT:\n                case IUniformType.UNSIGNED_INT:\n                case IUniformType.SAMPLER_2D: // For 2D textures, we specify the texture unit.\n                case IUniformType.SAMPLER_CUBE: // For CubeMap textures, we specify the texture unit.\n                    this.attachProgramInt(gl, prg, uniformName, isArray)\n                    break\n                case IUniformType.FLOAT:\n                    this.attachProgramFloat(gl, prg, uniformName, isArray)\n                    break\n                case IUniformType.FLOAT_VEC2:\n                    this.attachProgramVec2(gl, prg, uniformName, isArray)\n                    break\n                case IUniformType.FLOAT_VEC3:\n                    this.attachProgramVec3(gl, prg, uniformName, isArray)\n                    break\n                case IUniformType.FLOAT_VEC4:\n                    this.attachProgramVec4(gl, prg, uniformName, isArray)\n                    break\n                case IUniformType.FLOAT_MAT2:\n                    this.attachProgramMat2(gl, prg, uniformName, isArray)\n                    break\n                case IUniformType.FLOAT_MAT3:\n                    this.attachProgramMat3(gl, prg, uniformName, isArray)\n                    break\n                case IUniformType.FLOAT_MAT4:\n                    this.attachProgramMat4(gl, prg, uniformName, isArray)\n                    break\n                default:\n                    throw Error(`[AbstractShader.attachProgram] Unknown type for uniform \"${uniformName}\": ${uniformType.type}[${uniformType.size || 1}]!`)\n            }\n        }\n    }\n\n    private attachProgramInt(\n        gl: IWebGL,\n        prg: WebGLProgram,\n        uniformName: string,\n        isArray: boolean\n    ) {\n        const location = gl.getUniformLocation(prg, uniformName)\n        this.uniformSetters.set(\n            uniformName,\n            isArray ?\n                (v: Int32Array) => gl.uniform1iv(location, v) :\n                (v: number) => gl.uniform1i(location, v)\n        )\n    }\n\n    private attachProgramFloat(\n        gl: IWebGL,\n        prg: WebGLProgram,\n        uniformName: string,\n        isArray: boolean\n    ) {\n        const location = gl.getUniformLocation(prg, uniformName)\n        this.uniformSetters.set(\n            uniformName,\n            isArray ?\n                (v: Float32Array) => gl.uniform1fv(location, v) :\n                (v: number) => gl.uniform1f(location, v)\n        )\n    }\n\n    private attachProgramVec2(\n        gl: IWebGL,\n        prg: WebGLProgram,\n        uniformName: string,\n        isArray: boolean\n    ) {\n        if (isArray) throw Error(\"You cannot use array of vec2!\")\n        const location = gl.getUniformLocation(prg, uniformName)\n        this.uniformSetters.set(\n            uniformName,\n            (v: Float32Array) => gl.uniform2fv(location, v)\n        )\n    }\n\n    private attachProgramVec3(\n        gl: IWebGL,\n        prg: WebGLProgram,\n        uniformName: string,\n        isArray: boolean\n    ) {\n        if (isArray) throw Error(\"You cannot use array of vec3!\")\n        const location = gl.getUniformLocation(prg, uniformName)\n        this.uniformSetters.set(\n            uniformName,\n            (v: Float32Array) => gl.uniform3fv(location, v)\n        )\n    }\n\n    private attachProgramVec4(\n        gl: IWebGL,\n        prg: WebGLProgram,\n        uniformName: string,\n        isArray: boolean\n    ) {\n        if (isArray) throw Error(\"You cannot use array of vec4!\")\n        const location = gl.getUniformLocation(prg, uniformName)\n        this.uniformSetters.set(\n            uniformName,\n            (v: Float32Array) => gl.uniform4fv(location, v)\n        )\n    }\n\n    private attachProgramMat2(\n        gl: IWebGL,\n        prg: WebGLProgram,\n        uniformName: string,\n        isArray: boolean\n    ) {\n        if (isArray) throw Error(\"You cannot use array of mat2!\")\n        const location = gl.getUniformLocation(prg, uniformName)\n        this.uniformSetters.set(\n            uniformName,\n            (v: Float32Array) => gl.uniformMatrix2fv(location, false, v)\n        )\n    }\n\n    private attachProgramMat3(\n        gl: IWebGL,\n        prg: WebGLProgram,\n        uniformName: string,\n        isArray: boolean\n    ) {\n        if (isArray) throw Error(\"You cannot use array of mat3!\")\n        const location = gl.getUniformLocation(prg, uniformName)\n        this.uniformSetters.set(\n            uniformName,\n            (v: Float32Array) => gl.uniformMatrix3fv(location, false, v)\n        )\n    }\n\n    private attachProgramMat4(\n        gl: IWebGL,\n        prg: WebGLProgram,\n        uniformName: string,\n        isArray: boolean\n    ) {\n        if (isArray) throw Error(\"You cannot use array of mat4!\")\n        const location = gl.getUniformLocation(prg, uniformName)\n        this.uniformSetters.set(\n            uniformName,\n            (v: Float32Array) => gl.uniformMatrix4fv(location, false, v)\n        )\n    }\n}\n\nfunction displayWarningForNotFoundUniform(uniformName: string) {\n    console.warn(`Uniform \"${uniformName}\" has not been compiled in this program!`)\n    console.warn(\"Shader compilation removes everything that is not used by the code.\")\n}\n","import Shader from '../shader/abstract-shader'\nimport AsyncLoader from '../async-loader'\nimport LookupTables from '../lookup-tables'\nimport UniformSetter from './uniform-setters'\n\nimport {\n    IAttributeTypes,\n    IVaryingTypes,\n    IUniformTypes,\n    IFunctionTypes,\n    IWebGL\n} from '../types'\n\n\nconst BPE = Float32Array.BYTES_PER_ELEMENT\n\ninterface IWebGLAttribute {\n    location: number\n    size: number\n    type: number\n    normalization: boolean\n    totalSize: number\n    offset: number\n}\n\nexport default class Program {\n    private prg?: WebGLProgram\n    public readonly vertexShader: Shader\n    public readonly fragmentShader: Shader\n    // Attributes ready for binding.\n    private attributes: IWebGLAttribute[] = []\n    private uniformSetters?: UniformSetter\n\n    constructor(\n        private gl: IWebGL,\n        vertexShader: Shader,\n        fragmentShader: Shader\n    ) {\n        this.vertexShader = vertexShader\n        this.fragmentShader = fragmentShader\n    }\n\n    bindAttribs(buffer: WebGLBuffer) {\n        const { gl, prg, attributes } = this\n        if (!prg) throw Error(\"This program has not been attached yet!\")\n\n        gl.bindBuffer(gl.ARRAY_BUFFER, buffer)\n\n        for (const attrib of attributes) {\n            gl.enableVertexAttribArray(attrib.location)\n            gl.vertexAttribPointer(\n                attrib.location,\n                attrib.size,\n                gl.FLOAT,\n                attrib.normalization, // No normalisation.\n                attrib.totalSize,\n                attrib.offset\n            )\n        }\n    }\n\n    async attach() {\n        if (this.prg) this.detach()\n\n        const flatVertShader = flattenShaderDependencies(this.vertexShader)\n        const flatFragShader = flattenShaderDependencies(this.fragmentShader)\n\n        // No attributes in fragment shaders.\n        flatFragShader.attributes = {}\n        // Varying must reflect those of vertex shader.\n        flatFragShader.varyings = {\n            ...flatVertShader.varyings,\n            ...flatFragShader.varyings\n        }\n\n        const vertShaderCode = await flatVertShaderToCode(flatVertShader)\n        const fragShaderCode = await flatFragShaderToCode(flatFragShader)\n\n        const { gl } = this\n        const vertShader = createVertexShader(gl, vertShaderCode)\n        const fragShader = createFragementShader(gl, fragShaderCode)\n\n        const prg = gl.createProgram()\n        if (!prg) throw Error(\"Unable to create a new WebGLProgram!\")\n        this.prg = prg\n\n        gl.attachShader(prg, vertShader)\n        gl.attachShader(prg, fragShader)\n        gl.linkProgram(prg)\n\n        this.prepareUniformsForFastBinding(flatVertShader.attributes)\n        this.uniformSetters = new UniformSetter(\n            this.gl, this.prg, {\n                ...flatVertShader.uniforms,\n                ...flatFragShader.uniforms\n            }\n        )\n    }\n\n    get uniforms(): UniformSetter {\n        const { uniformSetters } = this\n        if (!uniformSetters) {\n            throw Error(\n                \"Can't get uniforms because the program has not been attached yet!\\nprg.attach()\"\n            )\n        }\n        return uniformSetters\n    }\n\n    detach() {\n        const { prg, gl } = this\n        if (!prg) return\n        gl.deleteProgram(prg)\n        delete this.prg\n    }\n\n    private prepareUniformsForFastBinding(attDef: IAttributeTypes) {\n        const { gl, prg } = this\n        if (!prg) throw Error(\"This program has not been attached yet!\")\n\n        const attributes: IWebGLAttribute[] = []\n        let offset = 0\n        for (const attName of Object.keys(attDef)) {\n            const attType = attDef[attName]\n            const location = gl.getAttribLocation(prg, attName)\n            const attrib: IWebGLAttribute = {\n                location,\n                offset,\n                normalization: false,\n                size: LookupTables.getAttributeSize(attType),\n                totalSize: 0,\n                type: LookupTables.getWebGLTypeFromAttributeType(gl, attType)\n            }\n            attributes.push(attrib)\n            offset += attrib.size * BPE\n        }\n\n        const totalSize = offset\n        for (const attrib of attributes) {\n            attrib.totalSize = totalSize\n        }\n\n        this.attributes = attributes\n    }\n\n    use() {\n        const { prg, gl } = this\n        if (!prg) throw Error(\"This program has not been attached yet!\")\n        gl.useProgram(prg)\n    }\n}\n\nfunction createVertexShader(gl: IWebGL, code: string) {\n    return createShader(gl.VERTEX_SHADER, gl, code)\n}\n\nfunction createFragementShader(gl: IWebGL, code: string) {\n    return createShader(gl.FRAGMENT_SHADER, gl, code)\n}\n\nfunction createShader(type: number, gl: IWebGL, code: string): WebGLShader {\n    if (type !== gl.VERTEX_SHADER && type !== gl.FRAGMENT_SHADER) {\n        throw Error('Type must be VERTEX_SHADER or FRAGMENT_SHADER!')\n    }\n    const shader = gl.createShader(type)\n    if (!shader) {\n        throw Error(\n            `Unable to create a ${type === gl.VERTEX_SHADER ? 'VERTEX' : 'FRAGMENT'} shader!`\n        )\n    }\n    gl.shaderSource(shader, code)\n    gl.compileShader(shader)\n    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n        const errorMessage: string = gl.getShaderInfoLog(shader) || \"NULL\"\n        console.error(`An error occurred compiling the shader with the following code:`)\n        // tslint:disable-next-line:no-console\n        console.info(writeLineNumbers(code))\n        // tslint:disable-next-line:no-console\n        console.error(`Here is the error: ${errorMessage}`)\n        // tslint:disable-next-line:no-console\n        console.info(getCodeSection(code, errorMessage))\n        // tslint:disable-next-line:no-console\n        throw Error(\n            `Unable to create a ${type === gl.VERTEX_SHADER ? 'VERTEX' : 'FRAGMENT'} shader!`\n        )\n    }\n\n    return shader\n}\n\nasync function flatVertShaderToCode(shader: IFlattenedShader): Promise<string> {\n    const code: string[] = []\n    const uniCode = getUniformsSourceCode(shader.uniforms)\n    if (uniCode) code.push(uniCode)\n    const attCode = getAttributesSourceCode(shader.attributes)\n    if (attCode) code.push(attCode)\n    const varCode = getVaryingsSourceCode(shader.varyings)\n    if (varCode) code.push(varCode)\n\n    const codeForFunctions = await getFunctionsSourceCode(shader.functions)\n    code.push(codeForFunctions)\n\n    return code.join(\"\\n\")\n}\n\nasync function flatFragShaderToCode(shader: IFlattenedShader): Promise<string> {\n    const code: string[] = [\n        \"precision mediump float;\"\n    ]\n    const uniCode = getUniformsSourceCode(shader.uniforms)\n    if (uniCode) code.push(uniCode)\n    const varCode = getVaryingsSourceCode(shader.varyings)\n    if (varCode) code.push(varCode)\n\n    const codeForFunctions = await getFunctionsSourceCode(shader.functions)\n    code.push(codeForFunctions)\n\n    return code.join(\"\\n\")\n}\n\nfunction getUniformsSourceCode(uniforms: IUniformTypes) {\n    return Object.keys(uniforms)\n        .map(name => {\n            const typeEnum = uniforms[name]\n            const type = LookupTables.getUniformTypeCodeName(typeEnum.type)\n            if (!type) {\n                throw Error(`Unknown type for uniform \"${name}\": ${typeEnum}!`)\n            }\n            const arraySuffix =\n                (typeEnum.size || 0) > 1 ?\n                    `[${typeEnum.size}]` : \"\"\n            return `uniform ${type} ${name}${arraySuffix};`\n        })\n        .join(\"\\n\")\n}\n\nfunction getVaryingsSourceCode(varyings: IVaryingTypes) {\n    return Object.keys(varyings)\n        .map(name => {\n            const typeEnum = varyings[name]\n            const type = LookupTables.getVaryingTypeCodeName(typeEnum.type)\n            if (!type) {\n                throw Error(`Unknown type for varying \"${name}\": ${typeEnum}!`)\n            }\n            const arraySuffix =\n                (typeEnum.size || 0) > 1 ?\n                    `[${typeEnum.size}]` : \"\"\n            return `varying ${type} ${name}${arraySuffix};`\n        })\n        .join(\"\\n\")\n}\n\nfunction getAttributesSourceCode(attributes: IAttributeTypes) {\n    return Object.keys(attributes)\n        .map(name => {\n            const typeEnum = attributes[name]\n            const typeString = LookupTables.getAttributeTypeCodeName(typeEnum)\n            if (!typeString) {\n                throw Error(`Unknown type for attribute \"${name}\": ${typeEnum}!`)\n            }\n            return `attribute ${typeString} ${name};`\n        })\n        .join(\"\\n\")\n}\n\nasync function getFunctionsSourceCode(functions: IFunctionTypes): Promise<string> {\n    const code: string[] = []\n    const functionNames = Object.keys(functions)\n\n    // Take the functions in reverve order because the dependencies\n    // must be declared first.\n    while (functionNames.length > 0) {\n        const functionName = functionNames.pop()\n        if (!functionName) break\n        const functionCodeUrlOrArray = functions[functionName]\n        if (Array.isArray(functionCodeUrlOrArray)) {\n            code.push(...functionCodeUrlOrArray)\n        } else {\n            const functionCode = await AsyncLoader.loadText(functionCodeUrlOrArray)\n            code.push(functionCode)\n        }\n    }\n\n    return code.join(\"\\n\")\n}\n\nconst RX_ERROR_MESSAGE = /ERROR: ([0-9]+):([0-9]+):/g\n\n/**\n * Return a portion of the code that is two lines before the error and two lines after.\n */\nfunction getCodeSection(code: string, errorMessage: string) {\n    const lines = code.split(/\\n\\r?/)\n    lines.unshift(\"\")  // Because lines numbers start at 1\n    RX_ERROR_MESSAGE.lastIndex = -1  // Reinit RegExp\n    const matcher = RX_ERROR_MESSAGE.exec(errorMessage)\n    if (!matcher) {\n        return code\n    }\n    const SURROUNDING_LINES = 2\n    const [, , lineNumberMatch] = matcher\n    const lineNumber = Number(lineNumberMatch)\n    const firstLine = Math.max(1, lineNumber - SURROUNDING_LINES)\n    const lastLine = Math.min(lines.length - 1, lineNumber + SURROUNDING_LINES)\n    const outputLines = [\"Here is an extract of the shader code:\"]\n    for (let n = firstLine; n <= lastLine; n++) {\n        outputLines.push(\n            `| ${n}:    ${lines[n]}`\n        )\n    }\n    return outputLines.join(\"\\n\")\n}\n\n/**\n * A shader can have dependencies.\n * The final shader code will be an aggregate of it's own code and of the\n * the code of all its dependencies.\n * Checks will be done to prevent declaration of same variables with\n * different types.\n */\nfunction flattenShaderDependencies(\n    shader: Shader,\n    shadersAlreadyLoaded: Shader[] = []\n): IFlattenedShader {\n    try {\n        const flattenedShader: IFlattenedShader = {\n            attributes: { ...shader.attributesDefinition },\n            functions: { ...shader.functionsDefinition },\n            uniforms: { ...shader.uniformsDefinition },\n            varyings: { ...shader.varyingsDefinition }\n        }\n\n        if (shadersAlreadyLoaded.length === 0 && typeof flattenedShader.functions.main === 'undefined') {\n            throw Error(\"A shader must have a 'void main()' function!\")\n        }\n        shadersAlreadyLoaded.push(shader)\n\n        for (const depShader of shader.dependenciesDefinition) {\n            // Skip already included shaders.\n            if (shadersAlreadyLoaded.indexOf(depShader) !== -1) continue\n\n            const depFlattenedShader: IFlattenedShader = {\n                attributes: { ...depShader.attributesDefinition },\n                functions: { ...depShader.functionsDefinition },\n                uniforms: { ...depShader.uniformsDefinition },\n                varyings: { ...depShader.varyingsDefinition }\n            }\n            // Remove potential main function because it has no sense for dependencies.\n            delete depFlattenedShader.functions.main\n\n            // Merge with current shader.\n            mergeAttributes(flattenedShader.attributes, depFlattenedShader.attributes)\n            mergeUniforms(flattenedShader.uniforms, depFlattenedShader.uniforms)\n            mergeVaryings(flattenedShader.varyings, depFlattenedShader.varyings)\n            mergeFunctions(flattenedShader.functions, depFlattenedShader.functions)\n        }\n\n        return flattenedShader\n    } catch (ex) {\n        throw Error(`Error in ${shader.constructor.name}:\\n${ex}`)\n    }\n}\n\n/**\n * We just ignore functions that have already been declared.\n * We don't check if the code is different.\n */\nfunction mergeFunctions(oldFunctions: IFunctionTypes, newFunctions: IFunctionTypes) {\n    for (const funName of Object.keys(newFunctions)) {\n        const oldFun = oldFunctions[funName]\n        const newFun = newFunctions[funName]\n        if (!oldFun) {\n            // Brand new attribute.\n            oldFunctions[funName] = newFun\n        }\n    }\n}\n\nfunction mergeAttributes(oldAttribs: IAttributeTypes, newAttribs: IAttributeTypes) {\n    for (const attName of Object.keys(newAttribs)) {\n        const oldAtt = oldAttribs[attName]\n        const newAtt = newAttribs[attName]\n        if (!oldAtt) {\n            // Brand new attribute.\n            oldAttribs[attName] = newAtt\n        } else {\n            // This attributes already exists.\n            // Check if the types are the same.\n            if (oldAtt !== newAtt) {\n                throw Error(`Attribute \"${attName}\" is redeclared in a dependency, but with a different type!`)\n            }\n        }\n    }\n}\n\nfunction mergeUniforms(oldUniforms: IUniformTypes, newUniforms: IUniformTypes) {\n    for (const uniName of Object.keys(newUniforms)) {\n        const oldUni = oldUniforms[uniName]\n        const newUni = newUniforms[uniName]\n        if (!oldUni) {\n            // Brand new uniform.\n            oldUniforms[uniName] = newUni\n        } else {\n            // This attributes already exists.\n            // Check if the types are the same.\n            if (oldUni.type !== newUni.type) {\n                throw Error(`Uniform \"${uniName}\" is redeclared in a dependency, but with a different type!`)\n            }\n            if ((oldUni.size || 1) !== (newUni.size || 1)) {\n                throw Error(`Uniform \"${uniName}[]\" is redeclared in a dependency, but with a different number of items!`)\n            }\n        }\n    }\n}\n\nfunction mergeVaryings(oldVarying: IVaryingTypes, newVarying: IVaryingTypes) {\n    for (const varName of Object.keys(newVarying)) {\n        const oldVar = oldVarying[varName]\n        const newVar = newVarying[varName]\n        if (!oldVar) {\n            // Brand new varying.\n            oldVarying[varName] = newVar\n        } else {\n            // This attributes already exists.\n            // Check if the types are the same.\n            if (oldVar.type !== newVar.type) {\n                throw Error(`Varying \"${varName}\" is redeclared in a dependency, but with a different type!`)\n            }\n            if ((oldVar.size || 1) !== (newVar.size || 1)) {\n                throw Error(`Varying \"${varName}[]\" is redeclared in a dependency, but with a different number of items!`)\n            }\n        }\n    }\n}\n\nfunction writeLineNumbers(code: string) {\n    const result: string[] = []\n    const lines = code.split(\"\\n\")\n    let lineNumber = 0\n    for (const line of lines) {\n        lineNumber++\n        result.push(`${pad(lineNumber)} | ${line}`)\n    }\n\n    return result.join(\"\\n\")\n}\n\nfunction pad(num: number, len: number = 3) {\n    let txt = `${num}`\n    while (txt.length < len) txt = ` ${txt}`\n    return txt\n}\n\ninterface IFlattenedShader {\n    attributes: IAttributeTypes\n    functions: IFunctionTypes\n    uniforms: IUniformTypes\n    varyings: IVaryingTypes\n}\n","import AbstractShader from '../../shader/abstract-shader'\nimport {\n    IAttributeType,\n    IAttributeTypes,\n    IVaryingType,\n    IVaryingTypes,\n    IUniformType,\n    IUniformTypes,\n    IFunctionTypes\n} from '../../types'\n\nexport default {\n    createVertShader: (def: Partial<IFriendlyVertexDefinition>) => new CustomShader(def),\n    createFragShader: (def: Partial<IFriendlyFragmentDefinition>) => new CustomShader(def)\n}\n\n\nclass CustomShader extends AbstractShader {\n    private readonly definition: IDefinition\n\n    constructor(def: Partial<IFriendlyDefinition>) {\n        super()\n        this.definition = {\n            uniforms: convertFriendlyUniforms(def.uniforms),\n            attributes: convertFriendlyAttributes(def.attributes),\n            varyings: convertFriendlyVaryings(def.varyings),\n            functions: def.functions || {},\n            dependencies: def.dependencies || [],\n        }\n    }\n\n    get uniformsDefinition() { return this.definition.uniforms }\n    get attributesDefinition() { return this.definition.attributes }\n    get varyingsDefinition() { return this.definition.varyings }\n    get functionsDefinition() { return this.definition.functions }\n    get dependenciesDefinition() { return this.definition.dependencies }\n}\n\n\nfunction convertFriendlyUniforms(uniforms?: IMap<IArray<IUniformStringType>>): IUniformTypes {\n    if (!uniforms) return {}\n\n    const result: IUniformTypes = {}\n    for (const key of Object.keys(uniforms)) {\n        result[key] = convertFriendlyUniform(uniforms[key])\n    }\n    return result\n}\n\nfunction convertFriendlyUniform(uniform: IArray<IUniformStringType>): { type: IUniformType, size: number } {\n    if (!Array.isArray(uniform)) return convertFriendlyUniform([uniform, 1])\n\n    const [stringType, size] = uniform\n    switch (stringType) {\n        case \"vec2\": return { type: IUniformType.FLOAT_VEC2, size }\n        case \"vec3\": return { type: IUniformType.FLOAT_VEC3, size }\n        case \"vec4\": return { type: IUniformType.FLOAT_VEC4, size }\n        case \"mat2\": return { type: IUniformType.FLOAT_MAT2, size }\n        case \"mat3\": return { type: IUniformType.FLOAT_MAT3, size }\n        case \"mat4\": return { type: IUniformType.FLOAT_MAT4, size }\n        case \"sampler2D\": return { type: IUniformType.SAMPLER_2D, size }\n        case \"samplerCube\": return { type: IUniformType.SAMPLER_CUBE, size }\n        default: return { type: IUniformType.FLOAT, size }\n    }\n}\n\n\nfunction convertFriendlyAttributes(attributes?: IMap<IAttributeStringType>): IAttributeTypes {\n    if (!attributes) return {}\n\n    const result: IAttributeTypes = {}\n    for (const key of Object.keys(attributes)) {\n        result[key] = convertFriendlyAttribute(attributes[key])\n    }\n    return result\n}\n\nfunction convertFriendlyAttribute(attribute: IArray<IAttributeStringType>): IAttributeType {\n    switch (attribute) {\n        case \"vec2\": return IAttributeType.FLOAT_VEC2\n        case \"vec3\": return IAttributeType.FLOAT_VEC3\n        case \"vec4\": return IAttributeType.FLOAT_VEC4\n        default: return IAttributeType.FLOAT\n    }\n}\n\n\nfunction convertFriendlyVaryings(varyings?: IMap<IArray<IVaryingStringType>>): IVaryingTypes {\n    if (!varyings) return {}\n\n    const result: IVaryingTypes = {}\n    for (const key of Object.keys(varyings)) {\n        result[key] = convertFriendlyVarying(varyings[key])\n    }\n    return result\n}\n\nfunction convertFriendlyVarying(varying: IArray<IVaryingStringType>): { type: IVaryingType, size: number } {\n    if (!Array.isArray(varying)) return convertFriendlyVarying([varying, 1])\n\n    const [stringType, size] = varying\n    switch (stringType) {\n        case \"vec2\": return { type: IVaryingType.FLOAT_VEC2, size }\n        case \"vec3\": return { type: IVaryingType.FLOAT_VEC3, size }\n        case \"vec4\": return { type: IVaryingType.FLOAT_VEC4, size }\n        case \"mat2\": return { type: IVaryingType.FLOAT_MAT2, size }\n        case \"mat3\": return { type: IVaryingType.FLOAT_MAT3, size }\n        case \"mat4\": return { type: IVaryingType.FLOAT_MAT4, size }\n        default: return { type: IVaryingType.FLOAT, size }\n    }\n}\n\n\ninterface IDefinition {\n    uniforms: IUniformTypes\n    attributes: IAttributeTypes\n    varyings: IVaryingTypes\n    functions: IFunctionTypes\n    dependencies: AbstractShader[]\n}\n\ninterface IMap<T> { [key: string]: T }\ntype IArray<T> = T | [T, number]\n\ntype IUniformStringType =\n    \"float\" | \"vec2\" | \"vec3\" | \"vec4\" | \"mat2\" | \"mat3\" | \"mat4\" | \"sampler2D\" | \"samplerCube\"\ntype IAttributeStringType =\n    \"float\" | \"vec2\" | \"vec3\" | \"vec4\"\ntype IVaryingStringType =\n    \"float\" | \"vec2\" | \"vec3\" | \"vec4\" | \"mat2\" | \"mat3\" | \"mat4\"\n\ninterface IFriendlyFragmentDefinition {\n    uniforms: IMap<IArray<IUniformStringType>>\n    functions: IFunctionTypes\n    dependencies: AbstractShader[]\n}\n\ninterface IFriendlyVertexDefinition extends IFriendlyFragmentDefinition {\n    attributes: IMap<IAttributeStringType>\n    varyings: IMap<IArray<IVaryingStringType>>\n}\n\ntype IFriendlyDefinition = IFriendlyVertexDefinition\n","// tslint:disable:no-bitwise\nimport { IVec3, IVec4, IMat3, IMat4 } from '../types'\n\nconst FULL_TURN = 4096\nconst MODULO = FULL_TURN - 1\nconst HALF_TURN = 2048\nconst HALF = 0.5\nconst EPSILON = 0.00000001\n\nconst COS = new Float32Array(FULL_TURN)\nconst SIN = new Float32Array(FULL_TURN)\n\n// Prepare acceleration table for COS and SIN.\nfor (let i = 0; i < FULL_TURN; i++) {\n    const angle = (Math.PI * i) / HALF_TURN\n    COS[i] = Math.cos(angle)\n    SIN[i] = Math.sin(angle)\n}\n\n/**\n * Fast cosine.\n * Angle is define between 0 and 4095.\n * * PI/2  <=>  1023\n * * PI  <=>  2047\n * * 3*PI/2  <=>  3071\n */\nfunction cos(angle: number) {\n    return COS[(angle | 0) & MODULO]\n}\n\n/**\n * Fast sine.\n * Angle is define between 0 and 4095.\n * * PI/2  <=>  1023\n * * PI  <=>  2047\n * * 3*PI/2  <=>  3071\n */\nfunction sin(angle: number) {\n    return SIN[(angle | 0) & MODULO]\n}\n\n/**\n * Force a number to stay between two bounds.\n */\nfunction clamp(v: number, min = 0, max = 1) {\n    if (v < min) return min\n    if (v > max) return max\n    return v\n}\n\nconst M4_00 = 0\nconst M4_10 = 1\nconst M4_20 = 2\nconst M4_30 = 3\nconst M4_01 = 4\nconst M4_11 = 5\nconst M4_21 = 6\nconst M4_31 = 7\nconst M4_02 = 8\nconst M4_12 = 9\nconst M4_22 = 10\nconst M4_32 = 11\nconst M4_03 = 12\nconst M4_13 = 13\nconst M4_23 = 14\nconst M4_33 = 15\n\nconst M3_00 = 0\nconst M3_10 = 1\nconst M3_20 = 2\nconst M3_01 = 3\nconst M3_11 = 4\nconst M3_21 = 5\nconst M3_02 = 6\nconst M3_12 = 7\nconst M3_22 = 8\n\nconst V_0 = 0\nconst V_1 = 1\nconst V_2 = 2\nconst V_3 = 3\n\nconst X = 0\nconst Y = 1\nconst Z = 2\nconst W = 3\n\nconst vector = {\n    areEqual(a: Float32Array, b: Float32Array): boolean {\n        if (a.length !== b.length) return false\n        for (let i = 0; i < a.length; i++) {\n            if (a[i] !== b[i]) return false\n        }\n        return true\n    },\n\n    createVec3(): IVec3 {\n        const VEC3_LENGTH = 3\n        return new Float32Array(VEC3_LENGTH)\n    },\n\n    createVec4(): IVec4 {\n        const VEC4_LENGTH = 4\n        return new Float32Array(VEC4_LENGTH)\n    },\n\n    cross3(a: IVec3, b: IVec3, output: IVec3) {\n        output[X] = a[Y] * b[Z] - a[Z] * b[Y]\n        output[Y] = a[Z] * b[X] - a[X] * b[Z]\n        output[Z] = a[X] * b[Y] - a[Y] * b[X]\n    },\n\n    dot3(a: IVec3, b: IVec3): number {\n        const [xa, ya, za] = a\n        const [xb, yb, zb] = b\n        return xa * xb + ya * yb + za * zb\n    },\n\n    /**\n     * @return Length of a 3D vector.\n     */\n    length3(input: IVec3): number {\n        return Math.sqrt(vector.dot3(input, input))\n    },\n\n    /**\n     * Create a 3D vector with length 1.\n     */\n    normalize3(input: IVec3, output: IVec3) {\n        const len = vector.length3(input)\n        output[X] = input[X] * len\n        output[Y] = input[Y] * len\n        output[Z] = input[Z] * len\n    },\n\n    /**\n     * Create a 3D vector of length 1, pointing in latitude/longitude position.\n     * Latitude goes along with Y axis.\n     * orbital3(0, 0) === (0,0,-1)\n     *\n     * Latitude and longitude are expressed in radians.\n     */\n    orbital3(latitude: number, longitude: number, output: IVec3) {\n        const height = Math.sin(latitude)\n        const radius = Math.cos(latitude)\n        const angle = longitude - Math.PI * HALF\n        output[X] = radius * Math.cos(angle)\n        output[Y] = radius * Math.sin(angle)\n        output[Z] = height\n    },\n\n    /**\n     * @return Length of a 3D vector.\n     */\n    length4(input: IVec4): number {\n        const [x, y, z, w] = input\n        return Math.sqrt(x * x + y * y + z * z + w * w)\n    },\n\n    /**\n     * Create a 3D vector with length 1.\n     */\n    normalize4(input: IVec4, output: IVec4) {\n        const len = vector.length4(input)\n        output[X] = input[X] * len\n        output[Y] = input[Y] * len\n        output[Z] = input[Z] * len\n        output[W] = input[W] * len\n    },\n\n    transform4(mat: IMat4, vec: IVec4, out: IVec4) {\n        out[V_0] =\n            mat[M4_00] * vec[V_0] +\n            mat[M4_01] * vec[V_1] +\n            mat[M4_02] * vec[V_2] +\n            mat[M4_03] * vec[V_3]\n        out[V_1] =\n            mat[M4_10] * vec[V_0] +\n            mat[M4_11] * vec[V_1] +\n            mat[M4_12] * vec[V_2] +\n            mat[M4_13] * vec[V_3]\n        out[V_2] =\n            mat[M4_20] * vec[V_0] +\n            mat[M4_21] * vec[V_1] +\n            mat[M4_22] * vec[V_2] +\n            mat[M4_23] * vec[V_3]\n        out[V_3] =\n            mat[M4_30] * vec[V_0] +\n            mat[M4_31] * vec[V_1] +\n            mat[M4_32] * vec[V_2] +\n            mat[M4_33] * vec[V_3]\n    }\n}\n\nconst matrix = {\n    areEqual: vector.areEqual,\n\n    createMat3(): IMat3 {\n        const MAT3_LENGTH = 9\n        return new Float32Array(MAT3_LENGTH)\n    },\n\n    createMat4(): IMat4 {\n        const MAT4_LENGTH = 16\n        return new Float32Array(MAT4_LENGTH)\n    },\n\n    identity3(output: IMat3) {\n        output[M3_00] = 1\n        output[M3_10] = 0\n        output[M3_20] = 0\n        output[M3_01] = 0\n        output[M3_11] = 1\n        output[M3_21] = 0\n        output[M3_02] = 0\n        output[M3_12] = 0\n        output[M3_22] = 1\n    },\n\n    /**\n     * Extract a 3x3 matrix from the top/left corner of a 4x4 matrix.\n     */\n    extract3From4(mat4: IMat4, mat3: IMat3) {\n        mat3[M3_00] = mat4[M4_00]\n        mat3[M3_10] = mat4[M4_10]\n        mat3[M3_20] = mat4[M4_20]\n        mat3[M3_01] = mat4[M4_01]\n        mat3[M3_11] = mat4[M4_11]\n        mat3[M3_21] = mat4[M4_21]\n        mat3[M3_02] = mat4[M4_02]\n        mat3[M3_12] = mat4[M4_12]\n        mat3[M3_22] = mat4[M4_22]\n    },\n\n    multiply3(a: IMat3, b: IMat3, output: IMat3) {\n        output[M3_00] = a[M3_00] * b[M3_00] + a[M3_01] * b[M3_10] + a[M3_02] * b[M3_20]\n        output[M3_10] = a[M3_10] * b[M3_00] + a[M3_11] * b[M3_10] + a[M3_12] * b[M3_20]\n        output[M3_20] = a[M3_20] * b[M3_00] + a[M3_21] * b[M3_10] + a[M3_22] * b[M3_20]\n        output[M3_01] = a[M3_00] * b[M3_01] + a[M3_01] * b[M3_11] + a[M3_02] * b[M3_21]\n        output[M3_11] = a[M3_10] * b[M3_01] + a[M3_11] * b[M3_11] + a[M3_12] * b[M3_21]\n        output[M3_21] = a[M3_20] * b[M3_01] + a[M3_21] * b[M3_11] + a[M3_22] * b[M3_21]\n        output[M3_02] = a[M3_00] * b[M3_02] + a[M3_01] * b[M3_12] + a[M3_02] * b[M3_22]\n        output[M3_12] = a[M3_10] * b[M3_02] + a[M3_11] * b[M3_12] + a[M3_12] * b[M3_22]\n        output[M3_22] = a[M3_20] * b[M3_02] + a[M3_21] * b[M3_12] + a[M3_22] * b[M3_22]\n    },\n\n    identity4(output: IMat4) {\n        output[M4_00] = 1\n        output[M4_10] = 0\n        output[M4_20] = 0\n        output[M4_30] = 0\n        output[M4_01] = 0\n        output[M4_11] = 1\n        output[M4_21] = 0\n        output[M4_31] = 0\n        output[M4_02] = 0\n        output[M4_12] = 0\n        output[M4_22] = 1\n        output[M4_32] = 0\n        output[M4_03] = 0\n        output[M4_13] = 0\n        output[M4_23] = 0\n        output[M4_33] = 1\n    },\n\n    multiply4(a: IMat4, b: IMat4, output: IMat4) {\n        const output00 = a[M4_00] * b[M4_00] + a[M4_01] * b[M4_10] + a[M4_02] * b[M4_20] + a[M4_03] * b[M4_30]\n        const output10 = a[M4_10] * b[M4_00] + a[M4_11] * b[M4_10] + a[M4_12] * b[M4_20] + a[M4_13] * b[M4_30]\n        const output20 = a[M4_20] * b[M4_00] + a[M4_21] * b[M4_10] + a[M4_22] * b[M4_20] + a[M4_23] * b[M4_30]\n        const output30 = a[M4_30] * b[M4_00] + a[M4_31] * b[M4_10] + a[M4_32] * b[M4_20] + a[M4_33] * b[M4_30]\n        const output01 = a[M4_00] * b[M4_01] + a[M4_01] * b[M4_11] + a[M4_02] * b[M4_21] + a[M4_03] * b[M4_31]\n        const output11 = a[M4_10] * b[M4_01] + a[M4_11] * b[M4_11] + a[M4_12] * b[M4_21] + a[M4_13] * b[M4_31]\n        const output21 = a[M4_20] * b[M4_01] + a[M4_21] * b[M4_11] + a[M4_22] * b[M4_21] + a[M4_23] * b[M4_31]\n        const output31 = a[M4_30] * b[M4_01] + a[M4_31] * b[M4_11] + a[M4_32] * b[M4_21] + a[M4_33] * b[M4_31]\n        const output02 = a[M4_00] * b[M4_02] + a[M4_01] * b[M4_12] + a[M4_02] * b[M4_22] + a[M4_03] * b[M4_32]\n        const output12 = a[M4_10] * b[M4_02] + a[M4_11] * b[M4_12] + a[M4_12] * b[M4_22] + a[M4_13] * b[M4_32]\n        const output22 = a[M4_20] * b[M4_02] + a[M4_21] * b[M4_12] + a[M4_22] * b[M4_22] + a[M4_23] * b[M4_32]\n        const output32 = a[M4_30] * b[M4_02] + a[M4_31] * b[M4_12] + a[M4_32] * b[M4_22] + a[M4_33] * b[M4_32]\n        const output03 = a[M4_00] * b[M4_03] + a[M4_01] * b[M4_13] + a[M4_02] * b[M4_23] + a[M4_03] * b[M4_33]\n        const output13 = a[M4_10] * b[M4_03] + a[M4_11] * b[M4_13] + a[M4_12] * b[M4_23] + a[M4_13] * b[M4_33]\n        const output23 = a[M4_20] * b[M4_03] + a[M4_21] * b[M4_13] + a[M4_22] * b[M4_23] + a[M4_23] * b[M4_33]\n        const output33 = a[M4_30] * b[M4_03] + a[M4_31] * b[M4_13] + a[M4_32] * b[M4_23] + a[M4_33] * b[M4_33]\n\n        output[M4_00] = output00\n        output[M4_10] = output10\n        output[M4_20] = output20\n        output[M4_30] = output30\n        output[M4_01] = output01\n        output[M4_11] = output11\n        output[M4_21] = output21\n        output[M4_31] = output31\n        output[M4_02] = output02\n        output[M4_12] = output12\n        output[M4_22] = output22\n        output[M4_32] = output32\n        output[M4_03] = output03\n        output[M4_13] = output13\n        output[M4_23] = output23\n        output[M4_33] = output33\n    },\n\n    /**\n     * @return false if the matrix is not invertible.\n     */\n    invert4(a: IMat4, output: IMat4): boolean {\n        const [\n            a00, a10, a20, a30,\n            a01, a11, a21, a31,\n            a02, a12, a22, a32,\n            a03, a13, a23, a33\n        ] = a\n\n        const b00 = a00 * a11 - a01 * a10\n        const b01 = a00 * a12 - a02 * a10\n        const b02 = a00 * a13 - a03 * a10\n        const b03 = a01 * a12 - a02 * a11\n        const b04 = a01 * a13 - a03 * a11\n        const b05 = a02 * a13 - a03 * a12\n        const b06 = a20 * a31 - a21 * a30\n        const b07 = a20 * a32 - a22 * a30\n        const b08 = a20 * a33 - a23 * a30\n        const b09 = a21 * a32 - a22 * a31\n        const b10 = a21 * a33 - a23 * a31\n        const b11 = a22 * a33 - a23 * a32\n        // Calculate the determinant\n        const invDet = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06\n\n        if (Math.abs(invDet) < EPSILON) return false\n\n        const det = 1 / invDet\n\n        output[M4_00] = (a11 * b11 - a12 * b10 + a13 * b09) * det\n        output[M4_01] = (a02 * b10 - a01 * b11 - a03 * b09) * det\n        output[M4_02] = (a31 * b05 - a32 * b04 + a33 * b03) * det\n        output[M4_03] = (a22 * b04 - a21 * b05 - a23 * b03) * det\n        output[M4_10] = (a12 * b08 - a10 * b11 - a13 * b07) * det\n        output[M4_11] = (a00 * b11 - a02 * b08 + a03 * b07) * det\n        output[M4_12] = (a32 * b02 - a30 * b05 - a33 * b01) * det\n        output[M4_13] = (a20 * b05 - a22 * b02 + a23 * b01) * det\n        output[M4_20] = (a10 * b10 - a11 * b08 + a13 * b06) * det\n        output[M4_21] = (a01 * b08 - a00 * b10 - a03 * b06) * det\n        output[M4_22] = (a30 * b04 - a31 * b02 + a33 * b00) * det\n        output[M4_23] = (a21 * b02 - a20 * b04 - a23 * b00) * det\n        output[M4_30] = (a11 * b07 - a10 * b09 - a12 * b06) * det\n        output[M4_31] = (a00 * b09 - a01 * b07 + a02 * b06) * det\n        output[M4_32] = (a31 * b01 - a30 * b03 - a32 * b00) * det\n        output[M4_33] = (a20 * b03 - a21 * b01 + a22 * b00) * det\n\n        return true\n    },\n\n    /**\n     * Rotation around X axis of `angle` radians.\n     */\n    rotation4X(angle: number, output: IMat4) {\n        const c = Math.cos(angle)\n        const s = Math.sin(angle)\n\n        output[M4_00] = 1\n        output[M4_10] = 0\n        output[M4_20] = 0\n        output[M4_30] = 0\n\n        output[M4_01] = 0\n        output[M4_11] = c\n        output[M4_21] = s\n        output[M4_31] = 0\n\n        output[M4_02] = 0\n        output[M4_12] = -s\n        output[M4_22] = c\n        output[M4_32] = 0\n\n        output[M4_03] = 0\n        output[M4_13] = 0\n        output[M4_23] = 0\n        output[M4_33] = 1\n    },\n\n    /**\n     * Rotation around X axis of `angle` radians.\n     */\n    rotation4Y(angle: number, output: IMat4) {\n        const c = Math.cos(angle)\n        const s = Math.sin(angle)\n\n        output[M4_00] = c\n        output[M4_10] = 0\n        output[M4_20] = -s\n        output[M4_30] = 0\n\n        output[M4_01] = 0\n        output[M4_11] = 1\n        output[M4_21] = 0\n        output[M4_31] = 0\n\n        output[M4_02] = s\n        output[M4_12] = 0\n        output[M4_22] = c\n        output[M4_32] = 0\n\n        output[M4_03] = 0\n        output[M4_13] = 0\n        output[M4_23] = 0\n        output[M4_33] = 1\n    },\n\n    /**\n     * Rotation around X axis of `angle` radians.\n     */\n    rotation4Z(angle: number, output: IMat4) {\n        const c = Math.cos(angle)\n        const s = Math.sin(angle)\n\n        output[M4_00] = c\n        output[M4_10] = s\n        output[M4_20] = 0\n        output[M4_30] = 0\n\n        output[M4_01] = -s\n        output[M4_11] = c\n        output[M4_21] = 0\n        output[M4_31] = 0\n\n        output[M4_02] = 0\n        output[M4_12] = 0\n        output[M4_22] = 1\n        output[M4_32] = 0\n\n        output[M4_03] = 0\n        output[M4_13] = 0\n        output[M4_23] = 0\n        output[M4_33] = 1\n    }\n}\n\nfunction deg2rad(deg: number) {\n    const HALF_TURN_DEF = 180\n    return deg * Math.PI / HALF_TURN_DEF\n}\n\nfunction rad2deg(rad: number) {\n    const HALF_TURN_DEF = 180\n    return rad * HALF_TURN_DEF / Math.PI\n}\n\nexport default {\n    deg2rad, rad2deg,\n    cos, sin, clamp, vector, matrix,\n    M4_00, M4_10, M4_20, M4_30,\n    M4_01, M4_11, M4_21, M4_31,\n    M4_02, M4_12, M4_22, M4_32,\n    M4_03, M4_13, M4_23, M4_33,\n    M3_00, M3_10, M3_20,\n    M3_01, M3_11, M3_21,\n    M3_02, M3_12, M3_22\n}\n","import Program from \"../program\"\nimport Shader from '../shader/abstract-shader'\n\n/**\n * The Camera is responsible of transforming World coordinates into\n * Screen coordinates.\n * To do this, the Camera defines the following Vertex Shader function:\n *\n * ```glsl\n * vec4 worldPointToScreen(vec3 point)\n * ```\n *\n * And it can work only if the following attributes are defined:\n *\n * ```glsl\n * attribute float uniCanvasWidth;\n * attribute float uniCanvasHeight;\n * ```\n *\n * Because there is a lot of different cameras, they can need extra attributes.\n * That's why Camera provides two readonly properties:\n * * `glslUniforms`:\n * * `glslFunction`\n */\nexport default abstract class AbstractCamera {\n    abstract get vertexShader(): Shader\n\n    /**\n     * @param prg - Attributes have to be set in this Program.\n     * @param width - Canvas Width.\n     * @param height - Canvas Height.\n     * @param time - Time of the rendered frame in milliseconds.\n     * @param delta - Number of milliseconds since the last rendered frame.\n     */\n    abstract setUniformValues(\n        prg: Program,\n        width: number,\n        height: number,\n        time: number,\n        delta: number\n    ): void\n}\n","import Program from \"../program\"\nimport ShaderFactory from '../factory/shader'\nimport Shader from '../shader/abstract-shader'\nimport AbstractCamera from \"./abstract-camera\"\nimport Calc from \"../calc\"\nimport { IMat3, IMat4 } from '../types'\n\nconst HALF = 0.5\nconst HALF_PI = Math.PI * HALF\n// Its PI/2 - Epsilon\nconst ALMOST_HALF_PI = 1.570796326794896\n\n/**\n * Abstract camera for 3D space.\n */\nexport default abstract class Space3D extends AbstractCamera {\n    protected readonly cameraMatrix: IMat4 = Calc.matrix.createMat4()\n    private readonly rotationY = Calc.matrix.createMat4()\n    private readonly rotationX = Calc.matrix.createMat4()\n    private readonly transfo = Calc.matrix.createMat4()\n\n    /**\n     * The camera matrix holds all the transformations to get a point\n     * from the world space into the camera space. This matrix is 4x4\n     * and it allows translations.\n     * This function will return a 3x3 matrix without the translations.\n     * It can be useful for vectors instead of points.\n     */\n    extractCameraMatrix(mat3: IMat3) {\n        Calc.matrix.extract3From4(this.cameraMatrix, mat3)\n    }\n\n    /**\n     * The camera looks at (targetX, targetY, targetZ)\n     * and it is at a distance of `distance`.\n     * That defines a sphere. We use `latitude` and `longitude` to know\n     * where the camera lies on the sphere.\n     * For {dis: 1, lat: 0, lng: 0} the camera location will be (0,0,1).\n     * For {dis: 1, lat: 0, lng: 90} the camera location will be (1,0,0).\n     * Only the latitude will influence the Y coord.\n     *\n     * @param distance - Expressed in meters.\n     * @param latitude - Expressed in radians.\n     * @param longitude - Expressed in radians.\n     */\n    orbit(\n        targetX: number, targetY: number, targetZ: number,\n        distance: number, latitude: number, longitude: number\n    ) {\n        const { rotationY, rotationX, cameraMatrix } = this\n\n        const lat = Calc.clamp(latitude, -ALMOST_HALF_PI, ALMOST_HALF_PI)\n        const lng = longitude\n\n        Calc.matrix.rotation4X(-lat, rotationX)\n        Calc.matrix.rotation4Y(lng, rotationY)\n        Calc.matrix.multiply4(rotationY, rotationX, cameraMatrix)\n\n        const radius = Math.cos(lat)\n\n        const tX = targetX + distance * radius * Math.sin(lng)\n        const tY = targetZ + distance * Math.sin(lat)\n        const tZ = targetY + distance * radius * Math.cos(lng)\n\n        console.info(\"tX, tY, tZ=\", tX, tY, tZ)\n        console.info(\"rotationX=\", rotationX)\n        cameraMatrix[Calc.M4_03] = -tX\n        cameraMatrix[Calc.M4_13] = -tY\n        cameraMatrix[Calc.M4_23] = -tZ\n    }\n}\n","import Space3D from \"../space-3d\"\nimport Program from \"../../program\"\nimport ShaderFactory from '../../factory/shader'\nimport PerspectiveVertexShaderCode from \"./perspective.world-point-to-screen.vert\"\nimport Calc from \"../../calc\"\n\nconst HALF_TURN_DEG = 180\nconst DEFAULT_FIELD_ANGLE_DEG = 10\nconst DEFAULT_FIELD_ANGLE_RAD = DEFAULT_FIELD_ANGLE_DEG * Math.PI / HALF_TURN_DEG\nconst MAT4_LENGTH = 16\nconst HALF = 0.5\nconst DOUBLE = 2\n\nconst VERTEX_SHADER = ShaderFactory.createVertShader({\n    uniforms: {\n        uniPerspectiveMatrix: \"mat4\",\n        uniCameraMatrix: \"mat4\"\n    },\n    functions: {\n        worldPointToScreen: PerspectiveVertexShaderCode\n    }\n})\n\nexport default class Perspective extends Space3D {\n    private perspectiveMatrix = new Float32Array(MAT4_LENGTH)\n\n    /**\n     * Field view angle expressed in radians.\n     */\n    fieldAngle = DEFAULT_FIELD_ANGLE_RAD\n    near = 0.1\n    far = 1000\n\n    static VertexShader = VERTEX_SHADER\n\n    constructor() {\n        super()\n        const distance = 15\n        this.orbit(0, 0, 0, distance, 0, 0)\n    }\n\n    get vertexShader() { return Perspective.VertexShader }\n\n    /**\n     * @param prg - Attributes have to be set in this Program.\n     * @param width - Canvas Width.\n     * @param height - Canvas Height.\n     * @param time - Time of the rendered frame in milliseconds.\n     */\n    setUniformValues(prg: Program, width: number, height: number) {\n        const { near, far, fieldAngle } = this\n        const f = Math.tan(HALF * (Math.PI - fieldAngle))\n        const rangeInv = 1 / (near - far)\n\n        const result = this.perspectiveMatrix\n        result[Calc.M4_00] = f * height / width\n        result[Calc.M4_10] = 0\n        result[Calc.M4_20] = 0\n        result[Calc.M4_30] = 0\n\n        result[Calc.M4_01] = 0\n        result[Calc.M4_11] = f\n        result[Calc.M4_21] = 0\n        result[Calc.M4_31] = 0\n\n        result[Calc.M4_02] = 0\n        result[Calc.M4_12] = 0\n        result[Calc.M4_22] = (near + far) * rangeInv\n        result[Calc.M4_32] = -1\n\n        result[Calc.M4_03] = 0\n        result[Calc.M4_13] = 0\n        result[Calc.M4_23] = near * far * rangeInv * DOUBLE\n        result[Calc.M4_33] = 0\n\n        prg.use()\n        prg.uniforms.set(\"uniCameraMatrix\", this.cameraMatrix)\n        prg.uniforms.set(\"uniPerspectiveMatrix\", this.perspectiveMatrix)\n    }\n}\n","import ShaderFactory from '../../factory/shader'\nimport PerspectiveCamera from '../../camera/perpective'\n\nimport FragShaderMain from './model.main.frag'\nimport VertShaderMain from './model.main.vert'\n\n\nconsole.info(\"PerspectiveCamera.VertexShader=\", PerspectiveCamera.VertexShader)\n\nexport default {\n    vert: ShaderFactory.createVertShader({\n        attributes: {\n            attLocation: \"vec3\",\n            attUV: \"vec2\",\n            attNormal: \"vec3\",\n            attValley: \"vec3\",\n            attWeight: \"vec3\"\n        },\n        varyings: {\n            varNormal: \"vec3\",\n            varValley: \"vec3\",\n            varWeight: \"vec3\",\n            varUV: \"vec2\"\n        },\n        functions: {\n            main: VertShaderMain\n        },\n        dependencies: [PerspectiveCamera.VertexShader]\n    }),\n    frag: ShaderFactory.createFragShader({\n        uniforms: {\n            uniTexture: \"sampler2D\",\n            uniThickness: \"float\",\n            uniSmoothness: \"float\"\n        },\n        functions: {\n            main: FragShaderMain\n        }\n    })\n}\n","// tslint:disable:no-magic-numbers\nimport Scene from '../../scene'\nimport Model from './model'\nimport AssetsMap from '../../assets-map'\nimport AsyncLoader from '../../async-loader'\nimport Texture from '../texture/texture'\nimport Program from '../../program'\nimport ModelShader from '../../shader/model'\n\nimport PaletteTextureUrl from '../../assets/palette/default-64.png'\n\ninterface IModelInfo {\n    buffer: WebGLBuffer\n    attributesCount: number\n    name: string\n}\n\nexport default class ModelsFactory {\n    private infoMap = new AssetsMap<IModelInfo>()\n    private programMap = new AssetsMap<Program>()\n    private textureMap = new AssetsMap<Texture>()\n\n    constructor(private scene: Scene) { }\n\n    async createAsync(url: string): Promise<Model> {\n        const { scene } = this\n        const { infoMap, programMap, textureMap } = this\n\n        if (!infoMap.exists(url)) await this.createInfo(url)\n        if (!programMap.exists(url)) await this.createProgram(\"model\")\n        if (!textureMap.exists(url)) await this.createTexture(PaletteTextureUrl)\n\n        const info = infoMap.get(url) as IModelInfo\n        return new Model({\n            gl: scene.gl,\n            name: info.name,\n            attributesCount: info.attributesCount,\n            buffer: info.buffer,\n            program: programMap.get(\"model\") as Program,\n            texture: textureMap.get(PaletteTextureUrl) as Texture\n        })\n    }\n\n    private async createInfo(url: string): Promise<IModelInfo> {\n        const gl = this.scene.gl\n        const modelDef = (await AsyncLoader.loadJson(url)) as IMesh\n        const modelBuff = gl.createBuffer()\n        if (!modelBuff) throw Error(\"Unable to create a new WebGLBuffer!\")\n        const modelData = createTriangles(modelDef.data)\n        gl.bindBuffer(gl.ARRAY_BUFFER, modelBuff)\n        gl.bufferData(gl.ARRAY_BUFFER, modelData, gl.STATIC_DRAW)\n        const modelInfo: IModelInfo = {\n            attributesCount: Math.floor(modelDef.data.length / modelDef.attributes.length),\n            buffer: modelBuff,\n            name: modelDef.name\n        }\n        this.infoMap.add(url, modelInfo)\n        return modelInfo\n    }\n\n    private async createProgram(id: string): Promise<Program> {\n        const gl = this.scene.gl\n        const program = new Program(gl, ModelShader.vert, ModelShader.frag)\n        this.programMap.add(id, program)\n        await program.attach()\n        return program\n    }\n\n    private async createTexture(url: string): Promise<Texture> {\n        const { scene, textureMap } = this\n        const texture = await scene.textures.createImageTextureAsync(url)\n        textureMap.add(url, texture)\n        return texture\n    }\n}\n\n\ninterface IMesh {\n    name: string,\n    attributes: string[],\n    data: number[]\n}\n\n\nfunction createTriangles(data: number[], attributesCount: number = 8): Float32Array {\n    const result: number[] = []\n    let cursor = 0\n    const chunkSize = attributesCount * 3\n    while (cursor < data.length) {\n        const chunk = data.slice(cursor, cursor + chunkSize)\n        result.push(...createTriangle(chunk))\n        cursor += chunkSize\n    }\n    return new Float32Array(result)\n}\n\nfunction createTriangle(triCoords: number[]): number[] {\n    const [\n        ax, ay, az, au, av, nax, nay, naz,\n        bx, by, bz, bu, bv, nbx, nby, nbz,\n        cx, cy, cz, cu, cv, ncx, ncy, ncz\n    ] = triCoords\n    const [vBC, vCA, vAB] = [0, 0, 0]\n    // PtX, PtY, dist to AB, dist to BC, dist CA.\n    const result: number[] = [\n        ax, ay, az, au, av, nax, nay, naz, vBC, vCA, vAB, distToEdge(ax, ay, bx, by, cx, cy), 0, 0,\n        bx, by, bz, bu, bv, nbx, nby, nbz, vBC, vCA, vAB, 0, distToEdge(bx, by, cx, cy, ax, ay), 0,\n        cx, cy, cz, cu, cv, ncx, ncy, ncz, vBC, vCA, vAB, 0, 0, distToEdge(cx, cy, ax, ay, bx, by)\n    ]\n\n    return result\n}\n\nfunction squaredDist(ax: number, ay: number, bx: number, by: number): number {\n    const x = ax - bx\n    const y = ay - by\n    return x * x + y * y\n}\n\nfunction dist(ax: number, ay: number, bx: number, by: number): number {\n    return Math.sqrt(squaredDist(ax, ay, bx, by))\n}\n\nfunction distToEdge(px: number, py: number, e1x: number, e1y: number, e2x: number, e2y: number): number {\n    const edgeLength = dist(e1x, e1y, e2x, e2y)\n    if (edgeLength === 0) return 0\n    const ux = px - e1x\n    const uy = py - e1y\n    const vx = e2x - e1x\n    const vy = e2y - e1y\n    // Cross product casted into 2D.\n    // Only the Z axis is non null.\n    const cross = ux * vy - uy * vx\n    return Math.abs(cross / edgeLength)\n}\n","// tslint:disable:no-magic-numbers\nimport Tfw from 'tfw'\nimport React from \"react\"\nimport Scene from '../gl/scene'\nimport ModelFactory from '../gl/factory/model'\nimport PerspectiveCamera from '../gl/camera/perpective'\nimport Calc from '../gl/calc'\n\nimport \"./App.css\"\n\nconst Slider = Tfw.View.Slider\n\ninterface IAppProps {\n    className?: string\n}\n\ninterface IAppState {\n    thickness: number\n    smoothness: number\n    latitude: number\n    longitude: number\n    distance: number\n}\n\nexport default class App extends React.Component<IAppProps, IAppState> {\n    state = {\n        thickness: 0.1,\n        smoothness: 0.5,\n        latitude: 5,\n        longitude: 0,\n        distance: 16\n    }\n\n    private refCanvas = React.createRef<HTMLCanvasElement>()\n    private scene?: Scene\n    private camera = new PerspectiveCamera()\n\n    async componentDidMount() {\n        const canvas = this.refCanvas.current\n        if (!canvas) return\n        const scene = new Scene(canvas)\n        const modelFactory = new ModelFactory(scene)\n        const car = await modelFactory.createAsync(\"./mesh/Car.json\")\n        const { gl } = scene\n\n        scene.onAnimation = (time: number, width: number, height: number) => {\n            //gl.clearColor(0, 0.4, 0.867, 1.0)\n            gl.clearColor(0.3, 0.3, 0.4, 1.0)\n            gl.clearDepth(+1)\n            gl.depthFunc(gl.LESS)\n            gl.enable(gl.DEPTH_TEST)\n            gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT)\n            this.camera.setUniformValues(car.program, width, height)\n            car.paint()\n        }\n\n        this.scene = scene\n        scene.isRendering = false\n        this.refresh()\n    }\n\n    componentDidUpdate() {\n        this.refresh()\n    }\n\n    private refresh = Tfw.Throttler(\n        () => {\n            const { distance, latitude, longitude } = this.state\n            this.camera.orbit(\n                0, 0, 0,\n                distance, Calc.deg2rad(latitude), Calc.deg2rad(longitude)\n            )\n            if (this.scene) this.scene.refresh()\n        },\n        50\n    )\n\n    render() {\n        const classes = ['App', 'thm-bg0']\n        if (this.props.className) classes.push(this.props.className)\n\n        return (<div className={classes.join(' ')}>\n            <div className=\"controls\">\n                <canvas ref={this.refCanvas}></canvas>\n                <Slider\n                    label=\"Latitude\"\n                    min={-89}\n                    max={+89}\n                    step={1}\n                    value={this.state.latitude}\n                    onChange={latitude => this.setState({ latitude })}\n                />\n                <Slider\n                    label=\"Longitude\"\n                    min={-180}\n                    max={+180}\n                    step={1}\n                    value={this.state.longitude}\n                    onChange={longitude => this.setState({ longitude })}\n                />\n                <Slider\n                    label=\"Distance\"\n                    min={1}\n                    max={50}\n                    step={1}\n                    value={this.state.distance}\n                    onChange={distance => this.setState({ distance })}\n                />\n            </div>\n        </div>)\n    }\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import Tfw from 'tfw'\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\nimport * as serviceWorker from './serviceWorker'\n\nTfw.Theme.register(\n    \"default\", {\n        bg0: \"#222\",\n        bg3: \"#555\"\n    }\n)\nTfw.Theme.apply(\"default\")\nTfw.Font.loadJosefin()\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n"],"sourceRoot":""}